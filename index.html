<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy 18th Birthday My Love</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Google Fonts: Mali for cute handwriting style -->
    <link href="https://fonts.googleapis.com/css2?family=Mali:ital,wght@0,300;0,500;0,700;1,300&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body {
            font-family: 'Mali', cursive;
            background: linear-gradient(to bottom, #0f172a, #1e1b4b);
            overflow: hidden;
            touch-action: manipulation;
        }

        /* Custom Animations */
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(2deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(0.95); }
        }

        .animate-float { animation: float 3s ease-in-out infinite; }
        .animate-flicker { animation: flicker 0.1s infinite alternate; }

        .candle-flame {
            width: 12px;
            height: 24px;
            background: linear-gradient(to bottom, #fefce8, #facc15, #f97316);
            border-radius: 50% 50% 35% 35%;
            box-shadow: 0 0 10px #fbbf24, 0 0 20px #f59e0b;
            transform-origin: bottom center;
        }

        .smoke {
            width: 8px;
            height: 20px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 10px;
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            animation: smokeRise 1s forwards;
            opacity: 0;
        }

        @keyframes smokeRise {
            0% { opacity: 0.8; bottom: 10px; transform: translateX(-50%) scale(1); }
            100% { opacity: 0; bottom: 60px; transform: translateX(-60%) scale(2); }
        }
        
        /* Custom scrollbar for the letter */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1; 
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #888; 
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555; 
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Fireworks Component
        const Fireworks = () => {
            const canvasRef = useRef(null);

            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                let animationFrameId;
                let particles = [];

                const resizeCanvas = () => {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                };

                window.addEventListener('resize', resizeCanvas);
                resizeCanvas();

                class Particle {
                    constructor(x, y, color) {
                        this.x = x;
                        this.y = y;
                        this.color = color;
                        this.velocity = {
                            x: (Math.random() - 0.5) * 4,
                            y: (Math.random() - 0.5) * 4
                        };
                        this.alpha = 1;
                        this.friction = 0.96;
                    }

                    draw() {
                        ctx.globalAlpha = this.alpha;
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
                        ctx.fillStyle = this.color;
                        ctx.fill();
                    }

                    update() {
                        this.velocity.x *= this.friction;
                        this.velocity.y *= this.friction;
                        this.x += this.velocity.x;
                        this.y += this.velocity.y;
                        this.alpha -= 0.01;
                    }
                }

                const createFirework = (x, y) => {
                    const colors = ['#ff69b4', '#00ff7f', '#add8e6', '#ffd700', '#ff4500'];
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    for (let i = 0; i < 30; i++) {
                        particles.push(new Particle(x, y, color));
                    }
                };

                const animate = () => {
                    ctx.fillStyle = 'rgba(15, 23, 42, 0.2)'; // Trail effect
                    ctx.fillRect(0, 0, canvas.width, canvas.height);

                    // Random fireworks
                    if (Math.random() < 0.03) {
                        createFirework(
                            Math.random() * canvas.width,
                            Math.random() * canvas.height * 0.7
                        );
                    }

                    particles.forEach((particle, index) => {
                        if (particle.alpha > 0) {
                            particle.update();
                            particle.draw();
                        } else {
                            particles.splice(index, 1);
                        }
                    });

                    animationFrameId = requestAnimationFrame(animate);
                };

                animate();

                return () => {
                    window.removeEventListener('resize', resizeCanvas);
                    cancelAnimationFrame(animationFrameId);
                };
            }, []);

            return <canvas ref={canvasRef} className="fixed top-0 left-0 w-full h-full pointer-events-none z-0" />;
        };

        // Main App Component
        const App = () => {
            const [step, setStep] = useState(0); // 0: Intro, 1: Cake, 2: Letter
            const [candles, setCandles] = useState([true, true, true]); // 3 candles for representation
            const [showConfetti, setShowConfetti] = useState(false);
            
            // Files provided in prompt
            const snoopyImg = "image_77f6e6.jpg"; // Using jpg for one
            const greenmanImg = "image_77f72b.png"; // Using png for the other

            const handleBlowCandle = (index) => {
                const newCandles = [...candles];
                newCandles[index] = false;
                setCandles(newCandles);
                
                // If all candles blown
                if (newCandles.every(c => !c)) {
                    setTimeout(() => {
                        setShowConfetti(true);
                        setTimeout(() => setStep(2), 2000);
                    }, 500);
                }
            };

            // Sticker Component
            const Sticker = ({ src, alt, className, rotation }) => (
                <div className={`absolute ${className} transform ${rotation} p-2 bg-white shadow-lg rounded-lg animate-float transition-transform hover:scale-110 duration-300 z-20`}>
                    <img src={src} alt={alt} className="w-20 h-20 md:w-28 md:h-28 object-cover rounded-md" 
                         onError={(e) => {
                             // Fallback if image fails to load or for preview
                             e.target.style.display='none';
                             e.target.parentElement.innerHTML = `<div class="w-20 h-20 md:w-28 md:h-28 flex items-center justify-center bg-gray-100 text-xs text-center">${alt}</div>`;
                         }}
                    />
                </div>
            );

            return (
                <div className="relative w-full h-screen flex items-center justify-center p-4">
                    <Fireworks />

                    {/* Stage 0: Intro */}
                    {step === 0 && (
                        <div className="relative z-10 text-center animate-fade-in">
                            <Sticker src={snoopyImg} alt="Snoopy" className="-top-32 left-0 md:-left-20" rotation="-rotate-12" />
                            <Sticker src={greenmanImg} alt="Green Man" className="-top-24 right-0 md:-right-20" rotation="rotate-12" />
                            
                            <div className="bg-white/90 backdrop-blur-sm p-8 rounded-2xl shadow-2xl max-w-md w-full border-4 border-pink-200">
                                <h1 className="text-4xl font-bold text-pink-600 mb-4">Happy Birthday!</h1>
                                <p className="text-xl text-slate-700 mb-2">‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å</p>
                                <p className="text-3xl font-bold text-indigo-600 mb-6">18 ‡∏Ç‡∏ß‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞!</p>
                                <button 
                                    onClick={() => setStep(1)}
                                    className="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-8 py-3 rounded-full text-xl font-bold shadow-lg hover:shadow-xl transform transition hover:scale-105 active:scale-95 animate-bounce"
                                >
                                    üéÅ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç üéÅ
                                </button>
                            </div>
                        </div>
                    )}

                    {/* Stage 1: The Cake */}
                    {step === 1 && (
                        <div className="relative z-10 flex flex-col items-center">
                            <h2 className="text-2xl text-white mb-8 text-shadow-lg font-bold animate-pulse">
                                {candles.some(c => c) ? "‡∏à‡∏¥‡πâ‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πà‡∏≤‡πÄ‡∏Ñ‡πâ‡∏Å‡πÄ‡∏•‡∏¢! üéÇüí®" : "‡πÄ‡∏¢‡πâ! ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!"}
                            </h2>
                            
                            {/* CSS Cake */}
                            <div className="relative mt-10">
                                {/* Cake Base */}
                                <div className="w-64 h-32 bg-amber-100 rounded-lg relative flex items-center justify-center shadow-xl border-b-8 border-amber-200">
                                    <div className="absolute top-0 w-full h-8 bg-pink-300 rounded-full transform -translate-y-1/2"></div> {/* Icing top */}
                                    <div className="absolute -bottom-2 w-72 h-4 bg-slate-300 rounded-full opacity-50 blur-sm"></div> {/* Shadow */}
                                    
                                    {/* Decor */}
                                    <div className="absolute top-0 left-4 w-4 h-8 bg-pink-400 rounded-b-full"></div>
                                    <div className="absolute top-0 left-12 w-4 h-6 bg-pink-400 rounded-b-full"></div>
                                    <div className="absolute top-0 left-20 w-4 h-9 bg-pink-400 rounded-b-full"></div>
                                    <div className="absolute top-0 right-4 w-4 h-7 bg-pink-400 rounded-b-full"></div>
                                    <div className="absolute top-0 right-16 w-4 h-5 bg-pink-400 rounded-b-full"></div>
                                    
                                    <div className="text-4xl font-bold text-pink-500 z-10">18</div>
                                </div>

                                {/* Candles */}
                                <div className="absolute -top-16 w-full flex justify-center gap-8">
                                    {candles.map((isLit, idx) => (
                                        <div key={idx} 
                                            className="relative flex flex-col items-center cursor-pointer transform hover:scale-110 transition"
                                            onClick={() => handleBlowCandle(idx)}
                                        >
                                            {isLit ? (
                                                <div className="candle-flame animate-flicker mb-1"></div>
                                            ) : (
                                                <div className="h-6 w-2 relative">
                                                    <div className="smoke"></div>
                                                </div>
                                            )}
                                            <div className="w-4 h-16 bg-gradient-to-b from-blue-300 to-blue-500 rounded-sm border border-blue-600"></div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* Greenman hiding behind cake */}
                             <img src={greenmanImg} alt="Green Man" className="absolute -bottom-10 -right-20 w-24 h-24 transform rotate-12 animate-float opacity-90" 
                                onError={(e) => e.target.style.display='none'}
                             />
                        </div>
                    )}

                    {/* Stage 2: The Letter */}
                    {step === 2 && (
                        <div className="relative z-20 w-full max-w-2xl px-4 animate-slide-up">
                            <div className="bg-white/95 backdrop-blur-md rounded-xl shadow-2xl overflow-hidden border-2 border-pink-100">
                                {/* Header */}
                                <div className="bg-pink-100 p-4 flex items-center justify-between">
                                    <div className="flex items-center gap-2">
                                        <img src={snoopyImg} alt="Snoopy" className="w-10 h-10 rounded-full object-cover border-2 border-white" onError={(e) => e.target.style.display='none'} />
                                        <span className="font-bold text-pink-600">‡∏ñ‡∏∂‡∏á ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤ ‚ù§Ô∏è</span>
                                    </div>
                                    <div className="text-pink-400">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" className="animate-pulse"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                                    </div>
                                </div>

                                {/* Body */}
                                <div className="p-6 md:p-8 overflow-y-auto max-h-[60vh] custom-scrollbar text-center space-y-4">
                                    <div className="text-lg md:text-xl text-slate-700 leading-relaxed font-medium">
                                        <p className="mb-4">‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ñ‡∏£‡∏ö 18 ‡∏õ‡∏µ‡∏ô‡∏∞‡∏Ñ‡∏ô‡πÄ‡∏Å‡πà‡∏á! üéâ</p>
                                        
                                        <p>
                                            ‡∏≠‡∏≤‡∏¢‡∏∏ 18 ‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á ‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏±‡∏ô‡∏°‡∏µ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç 
                                            ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡πâ‡∏≤‡πÑ‡∏õ‡∏ô‡∏≤‡∏ô‡πÜ ‡∏ô‡∏∞‡∏Ñ‡∏∞
                                        </p>
                                        <p>
                                            ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏Å‡∏•‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤ ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡πÄ‡∏ó‡∏≠‡∏à‡∏∞‡πÄ‡∏à‡∏≠‡∏≠‡∏∞‡πÑ‡∏£ 
                                            ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏Ñ‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏™‡∏°‡∏≠‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å üë´
                                        </p>
                                        <p className="font-bold text-pink-500">
                                            ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏≠‡πÄ‡∏à‡∏≠‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡∏ô‡∏∞...
                                        </p>
                                        <hr className="border-pink-200 my-4 w-1/2 mx-auto" />
                                        <p>
                                            ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏Å‡πÄ‡∏ó‡∏≠‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏£‡∏±‡∏Å‡∏ï‡∏•‡∏≠‡∏î‡πÑ‡∏õ <br/>
                                            ‡∏≠‡∏¢‡∏≤‡∏Å‡∏à‡∏∞‡∏Å‡∏≠‡∏î‡∏î‡∏î ‡∏à‡∏∏‡πâ‡∏ö‡πÜ ‡πÉ‡∏´‡πâ‡∏´‡∏≤‡∏¢‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡πÑ‡∏õ‡πÄ‡∏•‡∏¢‡∏¢‡∏¢ üòöüíï
                                        </p>
                                    </div>

                                    {/* Stickers inside card */}
                                    <div className="flex justify-center gap-4 mt-6">
                                        <img src={greenmanImg} alt="Green Man" className="w-16 h-16 animate-bounce" style={{animationDelay: '0.1s'}} onError={(e) => e.target.style.display='none'}/>
                                        <img src={snoopyImg} alt="Snoopy" className="w-16 h-16 animate-bounce" style={{animationDelay: '0.2s'}} onError={(e) => e.target.style.display='none'}/>
                                    </div>
                                </div>

                                {/* Footer */}
                                <div className="bg-slate-50 p-4 text-center">
                                    <button 
                                        onClick={() => { setStep(0); setCandles([true, true, true]); }}
                                        className="text-sm text-slate-400 hover:text-pink-500 transition underline"
                                    >
                                        ‡∏≠‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Confetti Overlay */}
                    {showConfetti && step !== 2 && (
                         <div className="fixed inset-0 pointer-events-none z-50 flex items-center justify-center">
                            {/* Simple CSS Confetti fallback visualization */}
                            <div className="text-6xl animate-ping">üéâ</div>
                         </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
